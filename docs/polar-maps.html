<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 3 Polar maps | Challenges working with data in polar regions</title>
  <meta name="description" content="Problems with data in polar regions, especially for mapping." />
  <meta name="generator" content="bookdown 0.13 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 3 Polar maps | Challenges working with data in polar regions" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Problems with data in polar regions, especially for mapping." />
  <meta name="github-repo" content="mdsumner/polar-mapping-oghub" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 3 Polar maps | Challenges working with data in polar regions" />
  
  <meta name="twitter:description" content="Problems with data in polar regions, especially for mapping." />
  

<meta name="author" content="Michael Sumner" />


<meta name="date" content="2019-08-29" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="setup.html"/>
<link rel="next" href="data-handling-in-polar-regions.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Polar Mapping in R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> About this</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#description-and-objectives"><i class="fa fa-check"></i><b>1.1</b> Description and objectives</a><ul>
<li class="chapter" data-level="1.1.1" data-path="index.html"><a href="index.html#references"><i class="fa fa-check"></i><b>1.1.1</b> References</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="setup.html"><a href="setup.html"><i class="fa fa-check"></i><b>2</b> Getting Set Up</a><ul>
<li class="chapter" data-level="2.1" data-path="setup.html"><a href="setup.html#data-sets"><i class="fa fa-check"></i><b>2.1</b> Data sets</a></li>
<li class="chapter" data-level="2.2" data-path="setup.html"><a href="setup.html#alternative-1"><i class="fa fa-check"></i><b>2.2</b> Alternative 1</a></li>
<li class="chapter" data-level="2.3" data-path="setup.html"><a href="setup.html#alternative-2"><i class="fa fa-check"></i><b>2.3</b> Alternative 2</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="polar-maps.html"><a href="polar-maps.html"><i class="fa fa-check"></i><b>3</b> Polar maps</a><ul>
<li class="chapter" data-level="3.1" data-path="polar-maps.html"><a href="polar-maps.html#projections"><i class="fa fa-check"></i><b>3.1</b> Projections</a></li>
<li class="chapter" data-level="3.2" data-path="polar-maps.html"><a href="polar-maps.html#mapping-in-r"><i class="fa fa-check"></i><b>3.2</b> Mapping in R</a></li>
<li class="chapter" data-level="3.3" data-path="polar-maps.html"><a href="polar-maps.html#exercise-1"><i class="fa fa-check"></i><b>3.3</b> Exercise 1</a><ul>
<li class="chapter" data-level="3.3.1" data-path="polar-maps.html"><a href="polar-maps.html#ex-1-answer"><i class="fa fa-check"></i><b>3.3.1</b> EX 1 ANSWER</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="polar-maps.html"><a href="polar-maps.html#exercise-2"><i class="fa fa-check"></i><b>3.4</b> Exercise 2</a><ul>
<li class="chapter" data-level="3.4.1" data-path="polar-maps.html"><a href="polar-maps.html#ex-2-answer"><i class="fa fa-check"></i><b>3.4.1</b> EX 2 ANSWER</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="polar-maps.html"><a href="polar-maps.html#polygon-catastrophe"><i class="fa fa-check"></i><b>3.5</b> Polygon catastrophe</a></li>
<li class="chapter" data-level="3.6" data-path="polar-maps.html"><a href="polar-maps.html#exercise-3"><i class="fa fa-check"></i><b>3.6</b> Exercise 3</a><ul>
<li class="chapter" data-level="3.6.1" data-path="polar-maps.html"><a href="polar-maps.html#ex-3-answer"><i class="fa fa-check"></i><b>3.6.1</b> EX 3 ANSWER</a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="polar-maps.html"><a href="polar-maps.html#lets-use-the-maps-data"><i class="fa fa-check"></i><b>3.7</b> Let’s use the maps data!</a></li>
<li class="chapter" data-level="3.8" data-path="polar-maps.html"><a href="polar-maps.html#reprojecting-to-polar-regions"><i class="fa fa-check"></i><b>3.8</b> Reprojecting to polar regions</a></li>
<li class="chapter" data-level="3.9" data-path="polar-maps.html"><a href="polar-maps.html#demonstration-of-the-projection-concept"><i class="fa fa-check"></i><b>3.9</b> Demonstration of the projection concept</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="data-handling-in-polar-regions.html"><a href="data-handling-in-polar-regions.html"><i class="fa fa-check"></i><b>4</b> Data handling in polar regions</a><ul>
<li class="chapter" data-level="4.1" data-path="data-handling-in-polar-regions.html"><a href="data-handling-in-polar-regions.html#exercise-4"><i class="fa fa-check"></i><b>4.1</b> Exercise 4</a><ul>
<li class="chapter" data-level="4.1.1" data-path="data-handling-in-polar-regions.html"><a href="data-handling-in-polar-regions.html#ex-4-answer"><i class="fa fa-check"></i><b>4.1.1</b> EX 4 ANSWER</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="data-handling-in-polar-regions.html"><a href="data-handling-in-polar-regions.html#overlay-between-different-projections"><i class="fa fa-check"></i><b>4.2</b> Overlay between different projections</a></li>
<li class="chapter" data-level="4.3" data-path="data-handling-in-polar-regions.html"><a href="data-handling-in-polar-regions.html#build-an-index-betweeen-the-raw-raster-data-and-the-polar-map-regions"><i class="fa fa-check"></i><b>4.3</b> Build an index betweeen the raw raster data and the polar map regions</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="somap.html"><a href="somap.html"><i class="fa fa-check"></i><b>5</b> SOmap</a><ul>
<li class="chapter" data-level="5.1" data-path="somap.html"><a href="somap.html#installation"><i class="fa fa-check"></i><b>5.1</b> Installation</a></li>
<li class="chapter" data-level="5.2" data-path="somap.html"><a href="somap.html#circumpolar-maps"><i class="fa fa-check"></i><b>5.2</b> Circumpolar maps</a></li>
<li class="chapter" data-level="5.3" data-path="somap.html"><a href="somap.html#adding-points"><i class="fa fa-check"></i><b>5.3</b> Adding points</a></li>
<li class="chapter" data-level="5.4" data-path="somap.html"><a href="somap.html#exercise-5"><i class="fa fa-check"></i><b>5.4</b> Exercise 5</a><ul>
<li class="chapter" data-level="5.4.1" data-path="somap.html"><a href="somap.html#ex-5-answer"><i class="fa fa-check"></i><b>5.4.1</b> EX 5 ANSWER</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="somap.html"><a href="somap.html#adding-data-layers"><i class="fa fa-check"></i><b>5.5</b> Adding data layers</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/mdsumner/polar-mapping-oghub" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Challenges working with data in polar regions</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="polar-maps" class="section level1">
<h1><span class="header-section-number">Chapter 3</span> Polar maps</h1>
<p>What is required for mapping in polar regions?</p>
<ul>
<li>shape-feature orientations, the dateline and the poles</li>
<li>handling of data in long-lat, understanding of metrics and shape (area, length, angle)</li>
<li>projected maps can be very hard to do, each has its own issues</li>
<li>quantities like vector fields</li>
<li>conventions for global data -180/180, 0/360</li>
</ul>
<div id="projections" class="section level2">
<h2><span class="header-section-number">3.1</span> Projections</h2>
<p>A brief overview here. For more please see the <a href="https://geocompr.robinlovelace.net/reproj-geo-data.html">geocompr book</a>.</p>
<p>Projections are used to solve particular measurement problems. These include <em>distance</em>, <em>area</em>, and <em>angle</em>.</p>
<ul>
<li><strong>Equal-area</strong> - area is simple, we can calculate planar area anywhere</li>
<li><strong>Equi-distant</strong> - less simple, applies along an axis or from one point only</li>
<li><strong>Conformal</strong> - preserves <em>shape</em>, i.e. angles are sensible</li>
</ul>
<p>No projection is perfect for every situation, and quite often tools will work in <em>geographic coordinates</em>, or raw longitude latitude values using algorithms suited for angular units on a sphere or ellipsoid.</p>
<p>Most projection specification is made by choosing an <a href="https://epsg.io/"><em>EPSG code</em></a>, and if one exists for your region then it’s a good choice. However, sometimes the right EPSG does not exist and it’s simpler to specify a custom projection.</p>
<p>Each <strong>+proj=</strong> code is a <em>projection family</em>, there are many more than shown here.</p>
<p>Lambert Azimuthal Equal Area</p>
<pre><code>+proj=laea +lon_0=0 +lat_0=-90 +datum=WGS84</code></pre>
<p>Polar Stereographic (south)</p>
<pre><code>+proj=stere +lon_0=0 +lat_0=-90 +lat_ts=-70 +datum=WGS84</code></pre>
<p>Longitude-Latitude</p>
<pre><code>+proj=longlat +datum=WGS84</code></pre>
<p>Lambert Conformal Conic</p>
<pre><code>+proj=lcc +lon_0=147 +lat_0=-42 +lat_1=-50 +lat_2=-35 +datum=WGS84</code></pre>
<p>Each of these has in common a <strong>central longitude and latitude</strong>, and many custom projections can be made using only these parameters.</p>
<p>Other parameters include</p>
<ul>
<li><strong>+x_0</strong>, <strong>+y_0</strong> - false easting (adds an arbitrary offset, usually to avoid negative coordinates)</li>
<li><strong>+lat_0</strong>, <strong>+lat_2</strong> - these are for conic projections, the <em>secant</em> latitudes</li>
<li><strong>+ellps</strong>, <strong>+no_defs</strong>, <strong>+over</strong> - various datum/ellipsoid specific</li>
<li><strong>+lat_ts</strong> - latitude of true scale projection specific, e.g. Stereographic</li>
<li><strong>+zone</strong>, <strong>+south</strong> - projection-specific parameters, e.g. for UTM</li>
</ul>
<p>Functions in R to expand EPSG parameters:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1">epsg &lt;-<span class="st"> </span><span class="dv">3412</span>   <span class="co">## south pole stereographic </span></a>
<a class="sourceLine" id="cb7-2" data-line-number="2">        <span class="co"># 3409 ## south polar equal area</span></a>
<a class="sourceLine" id="cb7-3" data-line-number="3">        <span class="co"># 3411 ## north polar stereographic (at 45W longitude, and Hughes 1980 ellipsoid)</span></a>
<a class="sourceLine" id="cb7-4" data-line-number="4">        <span class="co"># 3413 ## north polar stereographic (at 45W longitude, WGS84)</span></a>
<a class="sourceLine" id="cb7-5" data-line-number="5">prj &lt;-<span class="st"> </span><span class="kw">sprintf</span>(<span class="st">&quot;+init=epsg:%i&quot;</span>, epsg)</a>
<a class="sourceLine" id="cb7-6" data-line-number="6">rgdal<span class="op">::</span><span class="kw">CRSargs</span>(sp<span class="op">::</span><span class="kw">CRS</span>(prj))</a>
<a class="sourceLine" id="cb7-7" data-line-number="7"></a>
<a class="sourceLine" id="cb7-8" data-line-number="8"><span class="co">## sf is easier</span></a>
<a class="sourceLine" id="cb7-9" data-line-number="9">sf<span class="op">::</span><span class="kw">st_crs</span>(epsg)</a></code></pre></div>
</div>
<div id="mapping-in-r" class="section level2">
<h2><span class="header-section-number">3.2</span> Mapping in R</h2>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1"><span class="kw">library</span>(sp)</a>
<a class="sourceLine" id="cb8-2" data-line-number="2"><span class="kw">library</span>(raster)</a>
<a class="sourceLine" id="cb8-3" data-line-number="3"><span class="kw">library</span>(maps)</a>
<a class="sourceLine" id="cb8-4" data-line-number="4"><span class="kw">library</span>(rgdal)</a></code></pre></div>
<pre><code>## rgdal: version: 1.4-4, (SVN revision 833)
##  Geospatial Data Abstraction Library extensions to R successfully loaded
##  Loaded GDAL runtime: GDAL 2.4.2, released 2019/06/28
##  Path to GDAL shared files: /usr/share/gdal
##  GDAL binary built with GEOS: TRUE 
##  Loaded PROJ.4 runtime: Rel. 5.2.0, September 15th, 2018, [PJ_VERSION: 520]
##  Path to PROJ.4 shared files: (autodetected)
##  Linking to sp version: 1.3-1</code></pre>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1"><span class="kw">data</span>(<span class="st">&quot;wrld_simpl&quot;</span>, <span class="dt">package =</span> <span class="st">&quot;maptools&quot;</span>)</a></code></pre></div>
<p>The oldest general mapping tool in R is the <code>maps</code> package. It has a simple whole-world coastline data set for immediate use.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1">maps<span class="op">::</span><span class="kw">map</span>()</a></code></pre></div>
<p><img src="polar-mapping_files/figure-html/maps-package-1.png" width="672" /></p>
<p>The data underlying this live map is available by capturing the output as an
actual object.</p>
<p>If we look carefully at the southern edge and the eastern edge, notice that the
coastline for Antarctica does not extend to the south pole, and the Chukotka
region of Russia east of 180 longitude is not in the western part of the map.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1">maps_c &lt;-<span class="st"> </span>maps<span class="op">::</span><span class="kw">map</span>(<span class="dt">plot =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb12-2" data-line-number="2"></a>
<a class="sourceLine" id="cb12-3" data-line-number="3">lonlat &lt;-<span class="st"> </span><span class="kw">cbind</span>(maps_c<span class="op">$</span>x, maps_c<span class="op">$</span>y)</a>
<a class="sourceLine" id="cb12-4" data-line-number="4"></a>
<a class="sourceLine" id="cb12-5" data-line-number="5"><span class="kw">plot</span>(lonlat, <span class="dt">pch =</span> <span class="st">&quot;+&quot;</span>, <span class="dt">cex =</span> <span class="fl">0.4</span>, <span class="dt">axes =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb12-6" data-line-number="6"><span class="kw">lines</span>(lonlat, <span class="dt">col =</span> <span class="st">&quot;dodgerblue&quot;</span>)</a>
<a class="sourceLine" id="cb12-7" data-line-number="7"></a>
<a class="sourceLine" id="cb12-8" data-line-number="8"><span class="kw">abline</span>(<span class="dt">h =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">90</span>, <span class="dv">90</span>), <span class="dt">v =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">180</span>, <span class="dv">180</span>))</a></code></pre></div>
<p><img src="polar-mapping_files/figure-html/maps-assign-1.png" width="672" /></p>
<p>A very similar and slightly more modern data set is available in the <code>maptools</code> package.</p>
<p>(It’s not sensible use <code>maps</code> or <code>maptools</code> for coasline or country boundary data, but they
are handy for exploring concepts ).</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" data-line-number="1"><span class="kw">data</span>(<span class="st">&quot;wrld_simpl&quot;</span>, <span class="dt">package =</span> <span class="st">&quot;maptools&quot;</span>)</a>
<a class="sourceLine" id="cb13-2" data-line-number="2"></a>
<a class="sourceLine" id="cb13-3" data-line-number="3"><span class="kw">plot</span>(wrld_simpl)</a></code></pre></div>
<p><img src="polar-mapping_files/figure-html/wrld-simpl-1.png" width="672" /></p>
<p>This data set aligns exactly to the conventional -180/180 -90/90 extent of the longitude/latitude projection.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" data-line-number="1"><span class="kw">plot</span>(<span class="dv">0</span>, <span class="dt">type =</span> <span class="st">&quot;n&quot;</span>, <span class="dt">axes =</span> <span class="ot">FALSE</span>, <span class="dt">xlab =</span> <span class="st">&quot;&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;&quot;</span>, <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">180</span>, <span class="dv">180</span>), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">90</span>, <span class="dv">90</span>))</a>
<a class="sourceLine" id="cb14-2" data-line-number="2"><span class="kw">rect</span>(<span class="dt">xleft =</span> <span class="dv">-180</span>, <span class="dt">ybottom =</span> <span class="dv">-90</span>, <span class="dt">xright =</span> <span class="dv">180</span>, <span class="dt">ytop =</span> <span class="dv">90</span>, <span class="dt">border =</span> <span class="st">&quot;darkred&quot;</span>, <span class="dt">lwd =</span> <span class="dv">4</span>, <span class="dt">lty =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb14-3" data-line-number="3"><span class="kw">plot</span>(wrld_simpl, <span class="dt">add =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<p><img src="polar-mapping_files/figure-html/lon180-lat90-1.png" width="672" /></p>
</div>
<div id="exercise-1" class="section level2">
<h2><span class="header-section-number">3.3</span> Exercise 1</h2>
<p>How can we find the longitude and latitude ranges of the maps data <code>maps_c</code> and the maptools data <code>wrld_simpl</code>?</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" data-line-number="1"><span class="kw">str</span>(maps_c)</a></code></pre></div>
<pre><code>## List of 4
##  $ x    : num [1:82403] -69.9 -69.9 -69.9 -70 -70.1 ...
##  $ y    : num [1:82403] 12.5 12.4 12.4 12.5 12.5 ...
##  $ range: num [1:4] -180 190.3 -85.2 83.6
##  $ names: chr [1:1627] &quot;Aruba&quot; &quot;Afghanistan&quot; &quot;Angola&quot; &quot;Angola:Cabinda&quot; ...
##  - attr(*, &quot;class&quot;)= chr &quot;map&quot;</code></pre>
<div id="ex-1-answer" class="section level3">
<h3><span class="header-section-number">3.3.1</span> EX 1 ANSWER</h3>
<details>
<summary>SOLUTION</summary>
<p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" data-line-number="1"><span class="kw">range</span>(maps_c<span class="op">$</span>x, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] -180.0000  190.2708</code></pre>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" data-line-number="1"><span class="kw">range</span>(maps_c<span class="op">$</span>y, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] -85.19218  83.59961</code></pre>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" data-line-number="1"><span class="co">## OR </span></a>
<a class="sourceLine" id="cb21-2" data-line-number="2">maps_c<span class="op">$</span>range</a></code></pre></div>
<pre><code>## [1] -180.00000  190.27084  -85.19218   83.59961</code></pre>
</p>
</details>
</div>
</div>
<div id="exercise-2" class="section level2">
<h2><span class="header-section-number">3.4</span> Exercise 2</h2>
<p>Can we draw polygons with a fill colour with the maps package?</p>
<p>Why don’t these work?</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" data-line-number="1"><span class="kw">plot</span>(lonlat)</a>
<a class="sourceLine" id="cb23-2" data-line-number="2"><span class="kw">polygon</span>(lonlat, <span class="dt">col =</span> <span class="st">&quot;grey&quot;</span>)</a></code></pre></div>
<p><img src="polar-mapping_files/figure-html/maps-polygon-1.png" width="672" /></p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" data-line-number="1"><span class="kw">map</span>(maps_c, <span class="dt">fill =</span> <span class="ot">TRUE</span>, <span class="dt">col =</span> <span class="st">&quot;grey&quot;</span>)</a></code></pre></div>
<p><img src="polar-mapping_files/figure-html/maps-polygon-2.png" width="672" /></p>
<div id="ex-2-answer" class="section level3">
<h3><span class="header-section-number">3.4.1</span> EX 2 ANSWER</h3>
<details>
<summary>SOLUTION</summary>
<p>
<p>The actual data structure in the maps package is not suitable generally for subsetting polygons, or controlling
polygon drawing.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb25-1" data-line-number="1">maps<span class="op">::</span><span class="kw">map</span>(<span class="dt">fill =</span> <span class="ot">TRUE</span>, <span class="dt">col =</span> <span class="st">&quot;grey&quot;</span>)</a></code></pre></div>
<img src="polar-mapping_files/figure-html/maps-polygon-solution-1.png" width="672" />
</p>
</details>
</div>
</div>
<div id="polygon-catastrophe" class="section level2">
<h2><span class="header-section-number">3.5</span> Polygon catastrophe</h2>
<p>What’s going on? Look at the very south-eastern corner of the map. The “coastline” has been extended to the very south boundary of the available area.</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb26-1" data-line-number="1"><span class="kw">plot</span>(<span class="dv">0</span>, <span class="dt">type =</span> <span class="st">&quot;n&quot;</span>, <span class="dt">axes =</span> <span class="ot">FALSE</span>, <span class="dt">xlab =</span> <span class="st">&quot;&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;&quot;</span>, <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">150</span>, <span class="dv">180</span>), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">90</span>, <span class="dv">-60</span>))</a>
<a class="sourceLine" id="cb26-2" data-line-number="2"><span class="kw">plot</span>(wrld_simpl, <span class="dt">add =</span> <span class="ot">TRUE</span>, <span class="dt">col =</span> <span class="st">&quot;grey&quot;</span>)</a>
<a class="sourceLine" id="cb26-3" data-line-number="3"><span class="kw">rect</span>(<span class="dt">xleft =</span> <span class="dv">-180</span>, <span class="dt">ybottom =</span> <span class="dv">-90</span>, <span class="dt">xright =</span> <span class="dv">180</span>, <span class="dt">ytop =</span> <span class="dv">90</span>, <span class="dt">border =</span> <span class="st">&quot;darkred&quot;</span>, <span class="dt">lwd =</span> <span class="dv">4</span>, <span class="dt">lty =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb26-4" data-line-number="4"></a>
<a class="sourceLine" id="cb26-5" data-line-number="5">maps<span class="op">::</span><span class="kw">map</span>(<span class="dt">add =</span> <span class="ot">TRUE</span>, <span class="dt">col =</span> <span class="st">&quot;dodgerblue&quot;</span>, <span class="dt">lwd =</span> <span class="dv">3</span>)</a></code></pre></div>
<p><img src="polar-mapping_files/figure-html/south-east-1.png" width="672" /></p>
<p>When we add the old maps coastline see that it does not extend to 90S and it does not traverse the southern boundary.</p>
<p>One reason for this is that if we choose a projection where the east and west edges of the Antarctic coastline meet then we get what looks a fairly clean join.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb27-1" data-line-number="1"><span class="co">## scale factor</span></a>
<a class="sourceLine" id="cb27-2" data-line-number="2">f &lt;-<span class="st"> </span><span class="fl">3e6</span></a>
<a class="sourceLine" id="cb27-3" data-line-number="3"><span class="kw">plot</span>(rgdal<span class="op">::</span><span class="kw">project</span>(lonlat, <span class="st">&quot;+proj=laea +lat_0=-90 +datum=WGS84&quot;</span>), <span class="dt">asp =</span> <span class="dv">1</span>, <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>,</a>
<a class="sourceLine" id="cb27-4" data-line-number="4">     <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>) <span class="op">*</span><span class="st"> </span>f, <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>) <span class="op">*</span><span class="st"> </span>f, <span class="dt">xlab =</span> <span class="st">&quot;&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;&quot;</span>)</a></code></pre></div>
<p><img src="polar-mapping_files/figure-html/laea-1.png" width="672" /></p>
<p>If we try the same with <code>wrld_simpl</code> it’s not as neat. We have a strange “seam” that points exactly to the south pole (our projection is centred on longitude = 0, and latitude = -90.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb28-1" data-line-number="1"><span class="kw">plot</span>(sp<span class="op">::</span><span class="kw">spTransform</span>(wrld_simpl, <span class="st">&quot;+proj=laea +lat_0=-90 +datum=WGS84&quot;</span>), <span class="dt">asp =</span> <span class="dv">1</span>,</a>
<a class="sourceLine" id="cb28-2" data-line-number="2">     <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>) <span class="op">*</span><span class="st"> </span>f, <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>) <span class="op">*</span><span class="st"> </span>f, <span class="dt">xlab =</span> <span class="st">&quot;&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;&quot;</span>, <span class="dt">lwd =</span> <span class="dv">3</span>)</a>
<a class="sourceLine" id="cb28-3" data-line-number="3"><span class="kw">abline</span>(<span class="dt">v =</span> <span class="dv">0</span>, <span class="dt">h =</span> <span class="dv">0</span>, <span class="dt">lty =</span> <span class="dv">2</span>, <span class="dt">col =</span> <span class="st">&quot;grey&quot;</span>)</a></code></pre></div>
<p><img src="polar-mapping_files/figure-html/wrld-1.png" width="672" /></p>
</div>
<div id="exercise-3" class="section level2">
<h2><span class="header-section-number">3.6</span> Exercise 3</h2>
<p>How can we add our own data, a set of points, onto the polar map?</p>
<p>Add the <code>pts</code> matrix of longitude/latitude to this map, or define your points and add those.</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb29-1" data-line-number="1"><span class="kw">plot</span>(sp<span class="op">::</span><span class="kw">spTransform</span>(wrld_simpl, <span class="st">&quot;+proj=laea +lat_0=-90 +datum=WGS84&quot;</span>))</a></code></pre></div>
<p><img src="polar-mapping_files/figure-html/wrld-addplot-1.png" width="672" /></p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb30-1" data-line-number="1">pts &lt;-<span class="st"> </span><span class="kw">cbind</span>(<span class="kw">seq</span>(<span class="op">-</span><span class="dv">180</span>, <span class="dv">175</span>, <span class="dt">by =</span> <span class="dv">5</span>), </a>
<a class="sourceLine" id="cb30-2" data-line-number="2">             <span class="dv">-72</span>)</a></code></pre></div>
<p>Hint: we need the coordinate reference system string <strong>“+proj=laea +lat_0=-90 +datum=WGS84”</strong> and a function to transform a matrix of longitude-latitude values.</p>
<div id="ex-3-answer" class="section level3">
<h3><span class="header-section-number">3.6.1</span> EX 3 ANSWER</h3>
<details>
<summary>SOLUTION</summary>
<p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb31-1" data-line-number="1"><span class="kw">plot</span>(sp<span class="op">::</span><span class="kw">spTransform</span>(wrld_simpl, <span class="st">&quot;+proj=laea +lat_0=-90 +datum=WGS84&quot;</span>))</a>
<a class="sourceLine" id="cb31-2" data-line-number="2">pts &lt;-<span class="st"> </span><span class="kw">cbind</span>(<span class="kw">seq</span>(<span class="op">-</span><span class="dv">180</span>, <span class="dv">175</span>, <span class="dt">by =</span> <span class="dv">15</span>), </a>
<a class="sourceLine" id="cb31-3" data-line-number="3">             <span class="dv">-72</span>)</a>
<a class="sourceLine" id="cb31-4" data-line-number="4">ptsxy &lt;-<span class="st"> </span>rgdal<span class="op">::</span><span class="kw">project</span>(pts, <span class="st">&quot;+proj=laea +lat_0=-90 +datum=WGS84&quot;</span>)</a>
<a class="sourceLine" id="cb31-5" data-line-number="5"><span class="kw">points</span>(ptsxy)</a></code></pre></div>
<p><img src="polar-mapping_files/figure-html/wrld-addplot-soln-1.png" width="672" /></p>
</p>
</details>
</div>
</div>
<div id="lets-use-the-maps-data" class="section level2">
<h2><span class="header-section-number">3.7</span> Let’s use the maps data!</h2>
<p>In <code>maps_c</code> we have the maps data structure, and this looks promising.</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb32-1" data-line-number="1"><span class="kw">str</span>(maps_c)</a></code></pre></div>
<pre><code>## List of 4
##  $ x    : num [1:82403] -69.9 -69.9 -69.9 -70 -70.1 ...
##  $ y    : num [1:82403] 12.5 12.4 12.4 12.5 12.5 ...
##  $ range: num [1:4] -180 190.3 -85.2 83.6
##  $ names: chr [1:1627] &quot;Aruba&quot; &quot;Afghanistan&quot; &quot;Angola&quot; &quot;Angola:Cabinda&quot; ...
##  - attr(*, &quot;class&quot;)= chr &quot;map&quot;</code></pre>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb34-1" data-line-number="1">mp &lt;-<span class="st"> </span>maps_c</a>
<a class="sourceLine" id="cb34-2" data-line-number="2">pxy &lt;-<span class="st"> </span>rgdal<span class="op">::</span><span class="kw">project</span>(lonlat, <span class="st">&quot;+proj=laea +lat_0=-90 +datum=WGS84&quot;</span>)</a>
<a class="sourceLine" id="cb34-3" data-line-number="3">mp<span class="op">$</span>x &lt;-<span class="st"> </span>pxy[,<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb34-4" data-line-number="4">mp<span class="op">$</span>y &lt;-<span class="st"> </span>pxy[,<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb34-5" data-line-number="5">mp<span class="op">$</span>range &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">range</span>(mp<span class="op">$</span>x,<span class="dt">na.rm =</span> <span class="ot">TRUE</span>), <span class="kw">range</span>(mp<span class="op">$</span>y, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))</a>
<a class="sourceLine" id="cb34-6" data-line-number="6">mp<span class="op">$</span>range</a></code></pre></div>
<pre><code>## [1] -12709814  12704237 -12576156  12470787</code></pre>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb36-1" data-line-number="1"><span class="kw">plot</span>(<span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>) <span class="op">*</span><span class="st"> </span>f, <span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>) <span class="op">*</span><span class="st"> </span>f, <span class="dt">type =</span> <span class="st">&quot;n&quot;</span>, <span class="dt">asp =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb36-2" data-line-number="2">maps<span class="op">::</span><span class="kw">map</span>(mp, <span class="dt">add =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<p><img src="polar-mapping_files/figure-html/maps-data-1.png" width="672" /></p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb37-1" data-line-number="1"><span class="co">## but it doesn&#39;t take much to go awry</span></a>
<a class="sourceLine" id="cb37-2" data-line-number="2"><span class="kw">plot</span>(<span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>) <span class="op">*</span><span class="st"> </span>f, <span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>) <span class="op">*</span><span class="st"> </span>f, <span class="dt">type =</span> <span class="st">&quot;n&quot;</span>, <span class="dt">asp =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb37-3" data-line-number="3">maps<span class="op">::</span><span class="kw">map</span>(mp, <span class="dt">add =</span> <span class="ot">TRUE</span>, <span class="dt">fill =</span> <span class="ot">TRUE</span>, <span class="dt">col =</span> <span class="st">&quot;grey&quot;</span>)</a></code></pre></div>
<p><img src="polar-mapping_files/figure-html/maps-data-2.png" width="672" /></p>
<p>The problem is that the maps database has enough internal structure to join lines correctly, with <code>NA</code> gaps between different connected linestrings, but not enough to draw these things as polygons. A similar problem occurs in the default projection. While <code>wrld_simpl</code> has been extend by placing two dummy coordinates at the east and west versions of the south pole, this data set does not have those.</p>
<p>We have to look quite carefully to understand what is happening, but this is wrapping around overlapping itself and so close to the southern bound we barely notice.</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb38-1" data-line-number="1"><span class="kw">plot</span>(<span class="dv">0</span>, <span class="dt">type =</span> <span class="st">&quot;n&quot;</span>, <span class="dt">axes =</span> <span class="ot">FALSE</span>, <span class="dt">xlab =</span> <span class="st">&quot;&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;&quot;</span>, <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">180</span>, <span class="dv">-110</span>), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">90</span>, <span class="dv">-60</span>))</a>
<a class="sourceLine" id="cb38-2" data-line-number="2"></a>
<a class="sourceLine" id="cb38-3" data-line-number="3"><span class="kw">rect</span>(<span class="dt">xleft =</span> <span class="dv">-180</span>, <span class="dt">ybottom =</span> <span class="dv">-90</span>, <span class="dt">xright =</span> <span class="dv">180</span>, <span class="dt">ytop =</span> <span class="dv">90</span>, <span class="dt">border =</span> <span class="st">&quot;darkred&quot;</span>, <span class="dt">lwd =</span> <span class="dv">4</span>, <span class="dt">lty =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb38-4" data-line-number="4"></a>
<a class="sourceLine" id="cb38-5" data-line-number="5">maps<span class="op">::</span><span class="kw">map</span>(<span class="dt">add =</span> <span class="ot">TRUE</span>,<span class="dt">col =</span> <span class="st">&quot;grey&quot;</span>, <span class="dt">fill =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<p><img src="polar-mapping_files/figure-html/no-pole-1.png" width="672" /></p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb39-1" data-line-number="1">maps<span class="op">::</span><span class="kw">map</span>(<span class="dt">col =</span> <span class="st">&quot;grey&quot;</span>, <span class="dt">fill =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<p><img src="polar-mapping_files/figure-html/no-pole-2.png" width="672" /></p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb40-1" data-line-number="1">mpmerc &lt;-<span class="st"> </span>maps_c</a>
<a class="sourceLine" id="cb40-2" data-line-number="2">pxy &lt;-<span class="st"> </span>rgdal<span class="op">::</span><span class="kw">project</span>(lonlat, <span class="st">&quot;+proj=merc +datum=WGS84&quot;</span>)</a>
<a class="sourceLine" id="cb40-3" data-line-number="3">mpmerc<span class="op">$</span>x &lt;-<span class="st"> </span>pxy[,<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb40-4" data-line-number="4">mpmerc<span class="op">$</span>y &lt;-<span class="st"> </span>pxy[,<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb40-5" data-line-number="5">mpmerc<span class="op">$</span>range &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">range</span>(mpmerc<span class="op">$</span>x,<span class="dt">na.rm =</span> <span class="ot">TRUE</span>), <span class="kw">range</span>(mpmerc<span class="op">$</span>y, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))</a>
<a class="sourceLine" id="cb40-6" data-line-number="6">mpmerc<span class="op">$</span>range</a></code></pre></div>
<pre><code>## [1] -20037508  20037508 -20179524  18351859</code></pre>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb42-1" data-line-number="1"><span class="co">## the catastrophe made a little clearer </span></a>
<a class="sourceLine" id="cb42-2" data-line-number="2"><span class="kw">plot</span>(<span class="dv">0</span>, <span class="dt">xlim =</span> <span class="kw">range</span>(mpmerc<span class="op">$</span>range[<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>]), <span class="dt">ylim =</span> <span class="kw">c</span>(mpmerc<span class="op">$</span>range[<span class="dv">1</span>], <span class="dv">0</span>))</a>
<a class="sourceLine" id="cb42-3" data-line-number="3">maps<span class="op">::</span><span class="kw">map</span>(mpmerc,  <span class="dt">fill =</span> <span class="ot">TRUE</span>, <span class="dt">col =</span> <span class="st">&quot;grey&quot;</span>, <span class="dt">add =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<p><img src="polar-mapping_files/figure-html/no-pole-3.png" width="672" /></p>
</div>
<div id="reprojecting-to-polar-regions" class="section level2">
<h2><span class="header-section-number">3.8</span> Reprojecting to polar regions</h2>
<p>In essence it should be easy, but details really matter. Here the details of the format, the orientation and layout of the data (NetCDF, and common conventions used in physical ocean models)</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb43-1" data-line-number="1">sst &lt;-<span class="st"> </span>raster<span class="op">::</span><span class="kw">raster</span>(<span class="kw">system.file</span>(<span class="st">&quot;nc/reduced.nc&quot;</span>, <span class="dt">package =</span> <span class="st">&quot;stars&quot;</span>, <span class="dt">mustWork =</span> <span class="ot">TRUE</span>))</a></code></pre></div>
<pre><code>## Loading required namespace: ncdf4</code></pre>
<pre><code>## Warning in .varName(nc, varname, warn = warn): varname used is: sst
## If that is not correct, you can set it to one of: sst, anom, err, ice</code></pre>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb46-1" data-line-number="1"><span class="kw">plot</span>(raster<span class="op">::</span><span class="kw">projectRaster</span>(sst, <span class="dt">crs =</span> <span class="st">&quot;+proj=laea +lat_0=-90&quot;</span>))</a></code></pre></div>
<pre><code>## Warning in rgdal::rawTransform(projfrom, projto, nrow(xy), xy[, 1], xy[, :
## 48 projected point(s) not finite</code></pre>
<pre><code>## Warning in rgdal::rawTransform(projto_int, projfrom, nrow(xy), xy[, 1], :
## 6211 projected point(s) not finite</code></pre>
<p><img src="polar-mapping_files/figure-html/raster-reprojection-1.png" width="672" /></p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb49-1" data-line-number="1"><span class="kw">plot</span>(raster<span class="op">::</span><span class="kw">projectRaster</span>(<span class="kw">rotate</span>(sst), <span class="dt">crs =</span> <span class="st">&quot;+proj=laea +lat_0=-90&quot;</span>))</a></code></pre></div>
<pre><code>## Warning in rgdal::rawTransform(projfrom, projto, nrow(xy), xy[, 1], xy[, :
## 48 projected point(s) not finite</code></pre>
<pre><code>## Warning in rgdal::rawTransform(projto_int, projfrom, nrow(xy), xy[, 1], :
## 6213 projected point(s) not finite</code></pre>
<p><img src="polar-mapping_files/figure-html/raster-reprojection-2.png" width="672" /></p>
<p>Straight lines in longitude/latitude do not maintain their shape when reprojected unless we add extra vertices along lines of constant longitude and latitude. The longitudes are great circles, but the latitude lines are not.</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb52-1" data-line-number="1">grat_lines &lt;-<span class="st"> </span><span class="kw">rasterToPolygons</span>(<span class="kw">raster</span>(<span class="kw">extent</span>(<span class="op">-</span><span class="dv">180</span>, <span class="dv">180</span>, <span class="dv">-75</span>, <span class="dv">0</span>), </a>
<a class="sourceLine" id="cb52-2" data-line-number="2">                                      <span class="dt">crs =</span> <span class="st">&quot;+proj=longlat +datum=WGS84&quot;</span>, <span class="dt">res =</span> <span class="dv">30</span>))</a>
<a class="sourceLine" id="cb52-3" data-line-number="3"><span class="kw">plot</span>(<span class="kw">spTransform</span>(grat_lines, <span class="st">&quot;+proj=laea +lat_0=-90 +datum=WGS84&quot;</span>))</a></code></pre></div>
<p><img src="polar-mapping_files/figure-html/graticule-reproj-1.png" width="672" /></p>
<p>The pole is undefined in Mercator projection.</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb53-1" data-line-number="1">rgdal<span class="op">::</span><span class="kw">project</span>(<span class="kw">cbind</span>(<span class="op">-</span><span class="dv">180</span>, <span class="dv">0</span>), <span class="st">&quot;+proj=merc&quot;</span>)</a></code></pre></div>
<pre><code>##           [,1]         [,2]
## [1,] -20037508 7.081155e-10</code></pre>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb55-1" data-line-number="1">rgdal<span class="op">::</span><span class="kw">project</span>(<span class="kw">cbind</span>(<span class="op">-</span><span class="dv">180</span>, <span class="dv">-60</span>), <span class="st">&quot;+proj=merc&quot;</span>)</a></code></pre></div>
<pre><code>##           [,1]     [,2]
## [1,] -20037508 -8362699</code></pre>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb57-1" data-line-number="1">rgdal<span class="op">::</span><span class="kw">project</span>(<span class="kw">cbind</span>(<span class="op">-</span><span class="dv">180</span>, <span class="dv">-90</span>), <span class="st">&quot;+proj=merc&quot;</span>)</a></code></pre></div>
<pre><code>## Warning in rgdal::project(cbind(-180, -90), &quot;+proj=merc&quot;): 1 projected
## point(s) not finite</code></pre>
<pre><code>##      [,1] [,2]
## [1,]  Inf  Inf</code></pre>
<p>Sensible polar projections are stereographic and Lambert Azimuthal Equal Area. These are more or less identical over a large area, so knowing what is in use really matters!</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb60-1" data-line-number="1"><span class="kw">data</span>(<span class="st">&quot;wrld_simpl&quot;</span>, <span class="dt">package =</span> <span class="st">&quot;maptools&quot;</span>)</a>
<a class="sourceLine" id="cb60-2" data-line-number="2">laea &lt;-<span class="st"> &quot;+proj=laea +lon_0=0 +lat_0=-90 +datum=WGS84&quot;</span></a>
<a class="sourceLine" id="cb60-3" data-line-number="3">stere &lt;-<span class="st"> &quot;+proj=stere +lon_0=0 +lat_0=-90 +datum=WGS84&quot;</span></a>
<a class="sourceLine" id="cb60-4" data-line-number="4"></a>
<a class="sourceLine" id="cb60-5" data-line-number="5">wm &lt;-<span class="st"> </span>wrld_simpl[<span class="kw">coordinates</span>(wrld_simpl)[,<span class="dv">2</span>] <span class="op">&lt;</span><span class="st"> </span><span class="dv">30</span>, ]</a>
<a class="sourceLine" id="cb60-6" data-line-number="6"> </a>
<a class="sourceLine" id="cb60-7" data-line-number="7"><span class="co">## remember that plotting in R is usually *NOT* coordinate system aware ...</span></a>
<a class="sourceLine" id="cb60-8" data-line-number="8"></a>
<a class="sourceLine" id="cb60-9" data-line-number="9"><span class="kw">plot</span>(<span class="kw">spTransform</span>(wm, laea))</a>
<a class="sourceLine" id="cb60-10" data-line-number="10"><span class="kw">plot</span>(<span class="kw">spTransform</span>(wm, stere), <span class="dt">add =</span> <span class="ot">TRUE</span>, <span class="dt">border =</span> <span class="st">&quot;firebrick&quot;</span>)</a>
<a class="sourceLine" id="cb60-11" data-line-number="11"><span class="kw">points</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dt">cex =</span> <span class="dv">40</span>)</a></code></pre></div>
<p><img src="polar-mapping_files/figure-html/polar-laea-1.png" width="672" /></p>
<p>This video explains the Lambert Azimuthal Equal Area projection: <a href="https://www.youtube.com/watch?v=quzIU4nL9ig" class="uri">https://www.youtube.com/watch?v=quzIU4nL9ig</a> (crux at 2:25 with the spherical shells).</p>
</div>
<div id="demonstration-of-the-projection-concept" class="section level2">
<h2><span class="header-section-number">3.9</span> Demonstration of the projection concept</h2>
<p>3D plots that show various projection concepts.</p>
<p>First prepared here: <a href="http://mdsumner.github.io/2016/01/26/Three_Projections.html" class="uri">http://mdsumner.github.io/2016/01/26/Three_Projections.html</a></p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="setup.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="data-handling-in-polar-regions.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/mdsumner/polar-mapping-oghub/edit/master/02_basic-map-problems.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
